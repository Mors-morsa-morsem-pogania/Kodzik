import wave
import numpy as np
from os import listdir
import scipy
import matplotlib.pyplot as plt
import sklearn
import sklearn.mixture

import python_speech_features as python_speech_features

lista_plikow = listdir("E:\Studia\Semestr V\Technologia Mowy\ProjektI\Projekt_nr_1\\train\\")

lista_mfcc_nazwa=[] #stworzenie pustej listy 
for i in range(0,len(lista_plikow)):
    nazwa=lista_plikow[i] #wydobycie nazwy pliku  
    plik_=wave.open("train/"+nazwa, 'rb') #wczytanie pliku  
    plik = plik_.readframes(-1)
    plik = np.fromstring(plik, 'Int16')
    macierz_MFCC=python_speech_features.base.mfcc(plik, samplerate=plik_.getframerate(), numcep=13,
                                     nfft=int(0.03 * plik_.getframerate()), winfunc=np.hamming) #mfcc dla jednego pliku
    lista_mfcc_nazwa.append([macierz_MFCC,lista_plikow[i]]) #dodanie mfcc i nazwy do listy
    plik_.close()
    
print(lista_mfcc_nazwa[1])
print(len(lista_mfcc_nazwa)) #220 - zgadza sie 

slownik={} #stworzenie pustego słownika

for i in range(0,22):
    if i==0:
        slownik[str(lista_plikow[i * 10 + 1])[0:3]] = lista_mfcc_nazwa[0:10] #wybranie 10 cyfr dla danego mówcy i przypisanie ich do klucza (mówcy w słowniku)
    else:
        slownik[str(lista_plikow[i * 10 + 1])[0:3]] = lista_mfcc_nazwa[10*i+1:10*(i+1)]

print(len(slownik)) #dlugość 22 - zgadza sie
print(slownik["AO1"][1][1]) 

#Przydatne:
# # Odwołanie sie do wiersza w słowniku: np. slownik["AO1"]
# print(slownik["AO1"])
# # Odwołanie sie do wiersza w liście która jest w słowniku: np. slownik["AO1"][0]
# print(slownik["AO1"][0])
# # Odwołanie sie do macierzy MFCC w liście w słowniku: np. slownik["AO1"][0][0]
# print(slownik["AO1"][0][0])
# # Odwołanie sie do nazwy całego pliku w liście w słowniku: np. slownik["AO1"][0][1]
# print(slownik["AO1"][0][1])


#to sie przyda do GMM jak będziemy robić
wszystkie_cyfry_0=[]
for i in range(0,22):
    wszystkie_cyfry_0.extend(lista_mfcc_nazwa[i*10][0])

wszystkie_cyfry_1=[]
for i in range(0,22):
    wszystkie_cyfry_1.extend(lista_mfcc_nazwa[i*10+1][0])
